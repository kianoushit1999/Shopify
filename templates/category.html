{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
            rel="stylesheet"
    />
    <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.css"
            rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'css/category.css' %}">
</head>
<body>
{% include 'base/login_header.html' %}
<div class="container-swiper">
    <div class="row">
        <div class="col-10 p-5 d-flex flex-wrap">
            {% for obj in products %}
                {% for key,value in product_brand.items %}
                    {% if key == obj.brand.name %}
                        <div class="card mx-2 my-3 {{ obj.brand.name }} {{ value }}" value="{{ value }}"
                             style="width: 14rem;">
                            <img
                                    src="{{ obj.image.url }}"
                                    class="card-img-top"
                                    alt="..."
                            />
                            <div class="card-body text-center">
                                <p class="card-text">
                                    {{ obj.name }}<br/>
                                    {{ obj.details|truncatewords:15 }}
                                </p>
                                <a href="{% url "product:one_product" obj.slug %}" class="btn btn-primary"> Go </a>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
        <div class="col-2 py-5 px-2">
            <form id="brand">
                <h4 class="px-5 py-2"> brands </h4>
                {% for brand in brands %}
                    <div class="form-check pl-2">
                        <input
                                class="form-check-input brand"
                                type="checkbox"
                                value=""
                                checked
                                id="{{ brand.name }}"
                        />
                        <label class="form-check-label" for="{{ brand.name }}">
                            {{ brand.name }}
                        </label>
                    </div>
                {% endfor %}
            </form>
            <form id="shops">
                <h4 class="px-5 py-2"> shops </h4>
                {% for shop in shops %}
                    <div class="form-check pl-2">
                        <input
                                class="form-check-input shop"
                                type="checkbox"
                                value=""
                                checked
                                id="{{ shop.name }}"
                        />
                        <label class="form-check-label" for="{{ shop.name }}">
                            {{ shop.name }}
                        </label>
                    </div>
                {% endfor %}
            </form>
            <form id="categories">
                <h4 class="px-4 py-2"> categories </h4>
                <div class="form-check pl-2">
                    <input
                            class="form-check-input"
                            type="checkbox"
                            value=""
                            id="flexCheckDefault"
                    />
                    <label class="form-check-label" for="flexCheckDefault">
                        Default checkbox
                    </label>
                </div>
            </form>
        </div>
    </div>
</div>
{% include 'base/footer.html' %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script
        type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.0.0/mdb.min.js"
></script>
<script>
    $(".brand").on("change", function () {
        let brand = $(this).attr("id")
        console.log(brand)
        for (eleme of $(`.card.${brand}`)) {
            $(eleme).hasClass("d-none") ? $(eleme).removeClass("d-none") : $(eleme).addClass("d-none")
        }
    })
    $(".shop").on("change", function () {
        var shop_name = $(this).attr("id");
        for (eleme of $(`.card.${shop_name}`)) {
            let arr = ($(eleme).attr("value").trim() == "")? []: $(eleme).attr("value").trim().split(" ");
            if(arr.length != 0 && arr.includes(shop_name)) {
                if (arr.includes(shop_name)) {
                    arr = arr.filter((item) => {
                        return item != shop_name
                    })
                }
                (arr.length == 0) && $(eleme).addClass("d-none");
                console.log(arr)
                $(eleme).attr("value", arr.join(' '));
            }else{
                let shops = $(eleme).attr("value")
                $(eleme).attr("value", shops+` ${shop_name}`);
                $(eleme).removeClass("d-none")
                console.log(shop_name)
                console.log('-*-*-*-*-')
            }
            console.log(eleme)
        }
    })
</script>
</body>
</html>